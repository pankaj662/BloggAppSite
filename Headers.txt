ðŸ›¡ï¸ Security Headers (Browser Hardening) Kya Hote Hain?

Browser hardening = aap browser ko rules dete ho:

Kis origin se scripts load kar sakte hain

Browser ko iframe allow karna chahiye ya nahi

Clickjacking rokna hai ya nahi

XSS attack rokna hai ya nahi

Cookies kaise behave karengi

HSTS force karna ya nahi

Ye sab HTTP response headers se hota hai.

ðŸ”¥ Why Security Headers are Important?
Attack	Header Protection
XSS	CSP, X-XSS-Protection
Clickjacking	X-Frame-Options
CSRF attacks	SameSite cookie
Man-in-the-middle	HSTS
MIME sniffing	X-Content-Type-Options
Dangerous inline scripts	CSP




========================================================================================================================================================= = =
1ï¸âƒ£ Content-Security-Policy (CSP)

ðŸ”’ XSS, Script injection ko rokta hai.

Example:

Content-Security-Policy: default-src 'self'


Matlab:

Only same server se scripts/images/css allow

Strong CSP example:

Content-Security-Policy: default-src 'self'; script-src 'self'; object-src 'none';

2ï¸âƒ£ X-Frame-Options

ðŸ”’ Clickjacking rokta hai.

X-Frame-Options: DENY


Meaning â†’ koi bhi external site aapko iframe nahi kar sakti.

3ï¸âƒ£ Strict-Transport-Security (HSTS)

ðŸ”’ HTTP â†’ HTTPS force karta hai.
Man-in-the-middle attack ko rokta hai.

Strict-Transport-Security: max-age=31536000; includeSubDomains; preload

4ï¸âƒ£ X-Content-Type-Options

ðŸ”’ MIME sniffing attack ko block karta hai.

X-Content-Type-Options: nosniff

5ï¸âƒ£ Referrer-Policy

ðŸ”’ Userâ€™s browsing path leak hone se rokta hai.

Referrer-Policy: no-referrer

6ï¸âƒ£ Permissions-Policy

Browser features control karta hai:

Permissions-Policy: camera=(), microphone=(), geolocation=()


Meaning:

Camera â†’ disable

Mic â†’ disable

Geolocation â†’ disable

ðŸ§© Spring Boot me Security Headers kaise enable kare?
âœ” Method 1: Spring Security DSL (Recommended)
@Bean
public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
    http
        .headers(headers -> headers
                .contentSecurityPolicy(csp -> csp.policyDirectives("default-src 'self'"))
                .frameOptions(frame -> frame.deny())
                .xssProtection(xss -> xss.block(true))
                .httpStrictTransportSecurity(hsts -> hsts
                        .includeSubDomains(true)
                        .maxAgeInSeconds(31536000))
                .contentTypeOptions(withDefaults())
                .referrerPolicy(ref -> ref.policy(ReferrerPolicyHeaderWriter.ReferrerPolicy.NO_REFERRER))
                .permissionsPolicy(perm -> perm.policy("camera=(), microphone=(), geolocation=()"))
        );

    return http.build();
}

âœ” Ye kya enable karta hai?
Header	Protection
CSP	XSS block
X-Frame-Options DENY	Clickjacking block
XSS Protection	Old browsers ke liye fallback
HSTS	force HTTPS
NoSniff	MIME sniffing block
No-Referrer	privacy
Permissions-Policy	browser features control
ðŸ§ª Testing Security Headers

Tools:

Chrome DevTools â†’ Network â†’ Response Headers

Security Headers Checker (online)

curl commands:

curl -I https://your-domain.com

ðŸ§° Ready Security Header Package (copyâ€“paste)
http.headers(headers -> headers
        .contentSecurityPolicy(c -> c.policyDirectives("default-src 'self'; script-src 'self'"))
        .frameOptions(frame -> frame.deny())
        .xssProtection(xss -> xss.block(true))
        .httpStrictTransportSecurity(hsts -> hsts.maxAgeInSeconds(31536000).includeSubDomains(true))
        .contentTypeOptions(withDefaults())
        .referrerPolicy(r -> r.policy(ReferrerPolicy.NO_REFERRER))
        .permissionsPolicy(p -> p.policy("geolocation=(), camera=(), microphone=()"))
);

ðŸŽ¯ FINAL SUMMARY

Security Headers = Browser ko secure mode me chalane ke rules

âœ” XSS â†’ CSP
âœ” Clickjacking â†’ X-Frame-Options
âœ” HTTPS Only â†’ HSTS
âœ” MIME sniffing â†’ NoSniff
âœ” Referrer privacy â†’ Referrer-Policy
âœ” Browser features block â†’ Permissions-Policy